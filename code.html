<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Replication code for ‘Making, Updating, and Querying Causal Models using CausalQueries’</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
section.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
<script>
$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<link href="C:\Users\humphreys\AppData\Local\R\win-library\4.4\kableExtra\lightable-0.0.1\lightable.css" rel="stylesheet" />
</head>
<body>
<div class="frontmatter">
<div class="title"><h1>Replication code for ‘Making, Updating, and Querying Causal Models using CausalQueries’</h1></div>
<div class="author"><h2>Till Tietz, Lily Medina, Georgiy Syunyaev, and Macartan Humphreys</h2></div>
<div class="date"><h3>December 2024</h3></div>
</div>
<div class="body">
<p>Generated by <code>knitr::spin()</code> from <code>code.R</code>.</p>
<h2 id="set-up">Set up</h2>
<pre><code class="language-r">data(&quot;lipids_data&quot;)

lipids_data
</code></pre>
<h1 id="motivating-example">Motivating example</h1>
<pre><code class="language-r">lipids_model &lt;-  make_model(&quot;Z -&gt; X -&gt; Y; X &lt;-&gt; Y&quot;) 
</code></pre>
<pre><code class="language-r">lipids_model &lt;- update_model(lipids_model, lipids_data)
</code></pre>
<pre><code class="language-r">lipids_queries &lt;-
  query_model(
    lipids_model,
    queries = list(
      ATE  = &quot;Y[X=1] - Y[X=0]&quot;,
      PoC  = &quot;Y[X=1] - Y[X=0] :|: X==0 &amp; Y==0&quot;,
      LATE = &quot;Y[X=1] - Y[X=0] :|: X[Z=1] &gt; X[Z=0]&quot;),
    using = &quot;posteriors&quot;
  )
</code></pre>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:center;"> label </th>
   <th style="text-align:center;"> query </th>
   <th style="text-align:center;"> given </th>
   <th style="text-align:center;"> mean </th>
   <th style="text-align:center;"> sd </th>
   <th style="text-align:center;"> cred.low </th>
   <th style="text-align:center;"> cred.high </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> 0.55 </td>
   <td style="text-align:center;"> 0.10 </td>
   <td style="text-align:center;"> 0.37 </td>
   <td style="text-align:center;"> 0.73 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> PoC </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> X==0 &amp; Y==0 </td>
   <td style="text-align:center;"> 0.64 </td>
   <td style="text-align:center;"> 0.15 </td>
   <td style="text-align:center;"> 0.37 </td>
   <td style="text-align:center;"> 0.89 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> LATE </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> X[Z=1] &gt; X[Z=0] </td>
   <td style="text-align:center;"> 0.70 </td>
   <td style="text-align:center;"> 0.05 </td>
   <td style="text-align:center;"> 0.59 </td>
   <td style="text-align:center;"> 0.80 </td>
  </tr>
</tbody>
</table>
<pre><code class="language-r">lipids_queries |&gt; plot()
</code></pre>
<p><img src="data:image/png;base64,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" alt="Illustration of queries plotted" /></p>
<pre><code class="language-r">make_model(&quot;Z -&gt; X -&gt; Y; X &lt;-&gt; Y&quot;) |&gt;
  update_model(lipids_data) |&gt;
  query_model(
    queries = list(
      ATE  = &quot;Y[X=1] - Y[X=0]&quot;,
      PoC  = &quot;Y[X=1] - Y[X=0] :|: X==0 &amp; Y==0&quot;,
      LATE = &quot;Y[X=1] - Y[X=0] :|: X[Z=1] &gt; X[Z=0]&quot;),
    using = &quot;posteriors&quot;) |&gt;
  plot()
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-10" /></p>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:center;"> node </th>
   <th style="text-align:center;"> nodal_type </th>
   <th style="text-align:center;"> param_set </th>
   <th style="text-align:center;"> param_names </th>
   <th style="text-align:center;"> param_value </th>
   <th style="text-align:center;"> priors </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> Z.0 </td>
   <td style="text-align:center;"> 0.84 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> Z.1 </td>
   <td style="text-align:center;"> 0.16 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.00 </td>
   <td style="text-align:center;"> 0.12 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.10 </td>
   <td style="text-align:center;"> 0.08 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.01 </td>
   <td style="text-align:center;"> 0.11 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.11 </td>
   <td style="text-align:center;"> 0.69 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.00_X.00 </td>
   <td style="text-align:center;"> 0.38 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.10_X.00 </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.01_X.00 </td>
   <td style="text-align:center;"> 0.20 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.11_X.00 </td>
   <td style="text-align:center;"> 0.42 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.00_X.01 </td>
   <td style="text-align:center;"> 0.40 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.10_X.01 </td>
   <td style="text-align:center;"> 0.38 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.01_X.01 </td>
   <td style="text-align:center;"> 0.06 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.11_X.01 </td>
   <td style="text-align:center;"> 0.16 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.00_X.10 </td>
   <td style="text-align:center;"> 0.71 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.10_X.10 </td>
   <td style="text-align:center;"> 0.15 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.01_X.10 </td>
   <td style="text-align:center;"> 0.05 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.11_X.10 </td>
   <td style="text-align:center;"> 0.09 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.00_X.11 </td>
   <td style="text-align:center;"> 0.65 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.10_X.11 </td>
   <td style="text-align:center;"> 0.04 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.01_X.11 </td>
   <td style="text-align:center;"> 0.01 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.11_X.11 </td>
   <td style="text-align:center;"> 0.30 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
</tbody>
</table>
<h1 id="making-models">Making models</h1>
<pre><code class="language-r">model &lt;- make_model(&quot;X -&gt; M -&gt; Y &lt;- X&quot;)
</code></pre>
<pre><code class="language-r">lipids_model |&gt; plot()

lipids_model |&gt;
  plot(x_coord = 1:3,
       y_coord = 3:1,
       textcol = &quot;black&quot;,
       textsize = 3,
       shape = c(15, 16, 16),
       nodecol = &quot;lightgrey&quot;,
       nodesize = 10)
</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt="Examples of model graphs. For help on options see `?plot_model`" width="60%" /><img src="data:image/png;base64,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" alt="Examples of model graphs. For help on options see `?plot_model`" width="60%" />
<p class="caption">Examples of model graphs. For help on options see `?plot_model`</p>
</div>
<h2 id="tailoring-models">Tailoring models</h2>
<table>
<thead>
<tr>
<th align="left">Model</th>
<th align="center">Degrees of freedom</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W</code></td>
<td align="center">17</td>
</tr>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W; X &lt;-&gt; W</code></td>
<td align="center">18</td>
</tr>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W; X &lt;-&gt; Y; W &lt;-&gt; Y</code></td>
<td align="center">62</td>
</tr>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W; X &lt;-&gt; Y; W &lt;-&gt; Y; X &lt;-&gt; W</code></td>
<td align="center">63</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X</code></td>
<td align="center">19</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X; W &lt;-&gt; Y</code></td>
<td align="center">64</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X; X &lt;-&gt; W; W &lt;-&gt; Y</code></td>
<td align="center">67</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X; X &lt;-&gt; W; W &lt;-&gt; Y; X &lt;-&gt; Y</code></td>
<td align="center">127</td>
</tr>
</tbody>
</table>
<pre><code class="language-r">model_restricted &lt;- 
  lipids_model |&gt; 
  set_restrictions(&quot;X[Z=1] &lt; X[Z=0]&quot;)
</code></pre>
<pre><code class="language-r">model &lt;- 
  lipids_model |&gt;
  set_restrictions(labels = list(X = &quot;01&quot;, Y = c(&quot;00&quot;, &quot;01&quot;, &quot;11&quot;)), 
                   keep = TRUE)
</code></pre>
<pre><code class="language-r">model &lt;- lipids_model |&gt;
  set_restrictions(labels = list(Y = &quot;?0&quot;))
</code></pre>
<pre><code class="language-r">model &lt;- lipids_model |&gt;
  set_restrictions(labels = list(Y = c('00', '11')), given = 'X.00')
</code></pre>
<pre><code class="language-r">lipids_model |&gt; 
  inspect(&quot;prior_hyperparameters&quot;, nodes = &quot;X&quot;) 
</code></pre>
<pre><code>## 
## prior_hyperparameters
## Alpha parameter values used for Dirichlet prior distributions:
## 
## X.00 X.10 X.01 X.11 
##    1    1    1    1
</code></pre>
<pre><code class="language-r">model &lt;- lipids_model |&gt; 
  set_priors(distribution = &quot;jeffreys&quot;)
</code></pre>
<pre><code>## Altering all parameters.
</code></pre>
<pre><code class="language-r">lipids_model |&gt; 
  set_priors(param_names = c(&quot;X.10&quot;, &quot;X.01&quot;), alphas = 3:4) |&gt; 
  inspect(&quot;prior_hyperparameters&quot;, nodes = &quot;X&quot;)
</code></pre>
<pre><code>## 
## prior_hyperparameters
## Alpha parameter values used for Dirichlet prior distributions:
## 
## X.00 X.10 X.01 X.11 
##    1    3    4    1
</code></pre>
<pre><code class="language-r">lipids_model |&gt;
  set_priors(statement = &quot;X[Z=1] &gt; X[Z=0]&quot;, alphas = 3) |&gt;
  inspect(&quot;prior_hyperparameters&quot;, nodes = &quot;X&quot;)
</code></pre>
<pre><code>## 
## prior_hyperparameters
## Alpha parameter values used for Dirichlet prior distributions:
## 
## X.00 X.10 X.01 X.11 
##    1    1    3    1
</code></pre>
<pre><code class="language-r">query &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt;
  set_restrictions(decreasing(&quot;X&quot;, &quot;Y&quot;)) |&gt;
  query_model(&quot;Y[X=1] - Y[X=0]&quot;, using = &quot;priors&quot;)
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  inspect(&quot;parameters&quot;)
</code></pre>
<pre><code>## 
## parameters
## Model parameters with associated probabilities: 
## 
##  X.0  X.1 Y.00 Y.10 Y.01 Y.11 
## 0.50 0.50 0.25 0.25 0.25 0.25
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt;
  set_parameters(statement = &quot;Y[X=1] &gt; Y[X=0]&quot;, parameters = .7) |&gt;
  inspect(&quot;parameters&quot;)
</code></pre>
<pre><code>## 
## parameters
## Model parameters with associated probabilities: 
## 
##  X.0  X.1 Y.00 Y.10 Y.01 Y.11 
##  0.5  0.5  0.1  0.1  0.7  0.1
</code></pre>
<h2 id="drawing-data">Drawing data</h2>
<pre><code class="language-r">lipids_model |&gt; 
  make_data(n = 4)
</code></pre>
<pre><code class="language-r">sample_data &lt;-
  lipids_model |&gt;
  make_data(n = 8,
            nodes = list(c(&quot;Z&quot;, &quot;Y&quot;), &quot;X&quot;),
            probs = list(1, .5),
            subsets = list(TRUE, &quot;Z==1 &amp; Y==0&quot;))
</code></pre>
<pre><code class="language-r">sample_data |&gt; 
  collapse_data(lipids_model)
</code></pre>
<h1 id="updating-models">Updating models</h1>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  inspect(&quot;parameter_mapping&quot;) 
</code></pre>
<pre><code>## 
## parameter_mapping (Parameter mapping matrix) 
## 
##   Maps from parameters to data types, with
##   possibly multiple columns for each data type
##   in cases with confounding. 
## 
##      X0Y0 X1Y0 X0Y1 X1Y1
## X.0     1    0    1    0
## X.1     0    1    0    1
## Y.00    1    1    0    0
## Y.10    0    1    1    0
## Y.01    1    0    0    1
## Y.11    0    0    1    1
</code></pre>
<pre><code class="language-r">data &lt;- data.frame(X = rep(0:1, 5), Y = rep(0:1, 5))

list(
  uncensored = 
    update_model(make_model(&quot;X -&gt; Y&quot;),
                 data),
  censored = 
    update_model(make_model(&quot;X -&gt; Y&quot;), 
                 data, 
                 censored_types = c(&quot;X1Y0&quot;,  &quot;X0Y1&quot;))
  ) |&gt;
  query_model(&quot;Y[X=1] - Y[X=0]&quot;, using = &quot;posteriors&quot;)
</code></pre>
<pre><code>## 
## Causal queries generated by query_model (all at population level)
</code></pre>
<pre><code class="language-r">model &lt;-
  make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  update_model()
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code class="language-r">posterior &lt;- inspect(model, &quot;posterior_distribution&quot;)  
</code></pre>
<pre><code>## 
## posterior_distribution
## Summary statistics of model parameters posterior distributions:
## 
##   Distributions matrix dimensions are 
##   4000 rows (draws) by 6 cols (parameters)
## 
##      mean   sd
## X.0  0.51 0.28
## X.1  0.49 0.28
## Y.00 0.25 0.19
## Y.10 0.25 0.19
## Y.01 0.25 0.19
## Y.11 0.25 0.20
</code></pre>
<pre><code class="language-r">lipids_model &lt;- 
  lipids_model |&gt; 
  update_model(keep_fit = TRUE,
               keep_event_probabilities = TRUE)
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  update_model(keep_type_distribution = FALSE) |&gt;
  inspect(&quot;stan_summary&quot;) 
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code>## 
## stan_summary
## Stan model summary:
## 
## Inference for Stan model: simplexes.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##             mean se_mean   sd   2.5%   25%   50%   75% 97.5% n_eff Rhat
## X.0         0.50    0.01 0.29   0.03  0.25  0.49  0.74  0.97  3036    1
## X.1         0.50    0.01 0.29   0.03  0.26  0.51  0.75  0.97  3036    1
## Y.00        0.25    0.00 0.19   0.01  0.09  0.21  0.37  0.70  2031    1
## Y.10        0.25    0.00 0.19   0.01  0.09  0.21  0.37  0.71  4633    1
## Y.01        0.25    0.00 0.20   0.01  0.09  0.20  0.37  0.72  4162    1
## Y.11        0.25    0.00 0.20   0.01  0.09  0.20  0.37  0.71  4701    1
## lp__       -7.53    0.04 1.65 -11.75 -8.37 -7.15 -6.32 -5.44  1368    1
## 
## Samples were drawn using NUTS(diag_e) at Mon Feb 10 15:01:39 2025.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).
</code></pre>
<pre><code class="language-r">model &lt;- 
  make_model(&quot;X -&gt; M -&gt; Y&quot;) |&gt;
  update_model(data = data.frame(X = rep(0:1, 10000), Y = rep(0:1, 10000)), 
               iter = 5000,
               refresh = 0)
</code></pre>
<pre><code class="language-r">model
</code></pre>
<pre><code>## 
## Causal statement: 
## M -&gt; Y; X -&gt; M
## 
## Number of nodal types by node:
## X M Y 
## 2 4 4 
## 
## Number of causal types: 32
## 
## Model has been updated and contains a posterior distribution with
## 4 chains, each with iter=5000; warmup=2500; thin=1;  
## Use inspect(model, 'stan_summary') to inspect stan summary
## 
## Warnings passed from rstan during updating:
## The largest R-hat is 1.73, indicating chains have not mixed
## Bulk Effective Samples Size (ESS) is too low
## Tail Effective Samples Size (ESS) is too low
</code></pre>
<pre><code class="language-r">model &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt; 
  update_model(refresh = 0, keep_fit = TRUE)
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code class="language-r">model |&gt; 
  inspect(&quot;stanfit&quot;)
</code></pre>
<pre><code>## 
## stanfit
## Stan model summary:
## Inference for Stan model: simplexes.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##             mean se_mean   sd   2.5%   25%   50%   75% 97.5% n_eff Rhat
## lambdas[1]  0.50    0.01 0.29   0.03  0.25  0.50  0.75  0.97  2558    1
## lambdas[2]  0.50    0.01 0.29   0.03  0.25  0.50  0.75  0.97  2558    1
## lambdas[3]  0.25    0.00 0.20   0.01  0.09  0.20  0.37  0.71  2012    1
## lambdas[4]  0.26    0.00 0.20   0.01  0.10  0.21  0.38  0.72  4663    1
## lambdas[5]  0.25    0.00 0.20   0.01  0.08  0.20  0.37  0.71  4851    1
## lambdas[6]  0.25    0.00 0.19   0.01  0.09  0.20  0.36  0.71  4266    1
## types[1]    0.13    0.00 0.14   0.00  0.03  0.08  0.18  0.49  2317    1
## types[2]    0.12    0.00 0.13   0.00  0.02  0.07  0.18  0.49  2150    1
## types[3]    0.13    0.00 0.14   0.00  0.03  0.08  0.18  0.51  3350    1
## types[4]    0.13    0.00 0.13   0.00  0.03  0.08  0.18  0.50  3460    1
## types[5]    0.12    0.00 0.13   0.00  0.03  0.08  0.18  0.49  3676    1
## types[6]    0.12    0.00 0.14   0.00  0.02  0.08  0.18  0.51  3694    1
## types[7]    0.12    0.00 0.13   0.00  0.03  0.08  0.18  0.47  3424    1
## types[8]    0.12    0.00 0.13   0.00  0.03  0.08  0.18  0.49  3166    1
## lp__       -7.55    0.05 1.66 -11.87 -8.39 -7.15 -6.33 -5.45  1357    1
## 
## Samples were drawn using NUTS(diag_e) at Mon Feb 10 15:01:54 2025.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).
</code></pre>
<h1 id="querying-models">Querying models</h1>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  realise_outcomes()
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  realise_outcomes(dos = list(X = 1))
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  get_query_types(&quot;Y==1&quot;)
</code></pre>
<pre><code>## 
## Causal types satisfying query's condition(s)  
## 
##  query =  Y==1 
## 
## X0.Y10  X1.Y01
## X0.Y11  X1.Y11
## 
## 
##  Number of causal types that meet condition(s) =  4
##  Total number of causal types in model =  8
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  get_query_types(&quot;Y[X=1]==1&quot;)
</code></pre>
<pre><code>## 
## Causal types satisfying query's condition(s)  
## 
##  query =  Y[X=1]==1 
## 
## X0.Y01  X1.Y01
## X0.Y11  X1.Y11
## 
## 
##  Number of causal types that meet condition(s) =  4
##  Total number of causal types in model =  8
</code></pre>
<pre><code class="language-r">make_model(&quot;X1 -&gt; Y &lt;- X2&quot;)  |&gt;
  get_query_types(&quot;X1==1 &amp; X2==1 &amp; (Y[X1=1, X2=1] &gt; Y[X1=0, X2=0])&quot;)
</code></pre>
<pre><code>## 
## Causal types satisfying query's condition(s)  
## 
##  query =  X1==1&amp;X2==1&amp;(Y[X1=1,X2=1]&gt;Y[X1=0,X2=0]) 
## 
## X11.X21.Y0001  X11.X21.Y0101
## X11.X21.Y0011  X11.X21.Y0111
## 
## 
##  Number of causal types that meet condition(s) =  4
##  Total number of causal types in model =  64
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  get_query_types(&quot;Y[X=1] - Y[X=0]&quot;)
</code></pre>
<pre><code>## X0.Y00 X1.Y00 X0.Y10 X1.Y10 X0.Y01 X1.Y01 X0.Y11 X1.Y11 
##      0      0     -1     -1      1      1      0      0
</code></pre>
<pre><code class="language-r">data  &lt;- data.frame(X = rep(0:1, 50), Y = rep(0:1, 50))

model &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt;
  update_model(data, iter  = 4000, refresh = 0)

model |&gt; 
  grab(&quot;posterior_distribution&quot;)  |&gt; 
  ggplot(aes(Y.01 - Y.10)) + geom_histogram() 
</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Posterior on "Probability $Y$ is increasing in $X$"." width="60%" />
<p class="caption">Posterior on "Probability $Y$ is increasing in $X$".</p>
</div>
<pre><code class="language-r">queries &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt; 
  query_distribution(
    query = list(increasing = &quot;(Y[X=1] &gt; Y[X=0])&quot;,
                 ATE = &quot;(Y[X=1] - Y[X=0])&quot;), 
    using = &quot;priors&quot;)
</code></pre>
<pre><code class="language-r">lipids_model |&gt;
  query_model(
    query = &quot;Y[X=1] - Y[X=0] :|: X==1 &amp; Y==1 &amp; Z==1&quot;,
    using = &quot;posteriors&quot;) |&gt;
  plot()
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk case-level-query" /></p>
<pre><code class="language-r">make_model(&quot;X -&gt; M -&gt; Y&quot;) |&gt;
  update_model(data.frame(X = rep(0:1, 8), Y = rep(0:1, 8)), iter = 4000) |&gt;
  query_model(&quot;Y[X=1] &gt; Y[X=0] :|: X==1 &amp; Y==1 &amp; M==1&quot;, 
            using = &quot;posteriors&quot;,
            case_level = c(TRUE, FALSE)) |&gt;
  plot()
</code></pre>
<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-52" /></p>
<pre><code class="language-r">models &lt;- list(
  Unrestricted = lipids_model |&gt;
    update_model(data = lipids_data, refresh = 0),
  
  Restricted = lipids_model |&gt;
    set_restrictions(&quot;X[Z=1] &lt; X[Z=0]&quot;) |&gt;
    update_model(data = lipids_data, refresh = 0)
)
</code></pre>
<pre><code class="language-r">queries &lt;- 
  query_model(
    models,  
    query = list(ATE = &quot;Y[X=1] - Y[X=0]&quot;, 
                 POS = &quot;Y[X=1] &gt; Y[X=0] :|: Y==1 &amp; X==1&quot;),
    case_level = c(FALSE, TRUE),
    using = c(&quot;priors&quot;, &quot;posteriors&quot;),
    expand_grid = TRUE)
</code></pre>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:center;"> label </th>
   <th style="text-align:center;"> model </th>
   <th style="text-align:center;"> query </th>
   <th style="text-align:center;"> given </th>
   <th style="text-align:center;"> using </th>
   <th style="text-align:center;"> case_level </th>
   <th style="text-align:center;"> mean </th>
   <th style="text-align:center;"> sd </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 0.20 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 0.23 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.55 </td>
   <td style="text-align:center;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.56 </td>
   <td style="text-align:center;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.50 </td>
   <td style="text-align:center;"> 0.22 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.49 </td>
   <td style="text-align:center;"> 0.24 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.55 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] - Y[X=0] </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.56 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.50 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.49 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> Y[X=1] &gt; Y[X=0] </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
</tbody>
</table>
![Default plotting for a a set of queries over multiple models.](figure/fig-batch-1.png)
<h1 id="appendix">Appendix</h1>
<pre><code class="language-r">library(parallel)

options(mc.cores = parallel::detectCores())
</code></pre>
<pre><code class="language-r">library(future)
library(future.apply)

chains &lt;- 3
cores &lt;- 8

future::plan(list(
      future::tweak(future::multisession, 
                    workers = floor(cores/(chains + 1))),
      future::tweak(future::multisession, 
                    workers = chains)
    ))

model &lt;- make_model(&quot;X -&gt; Y&quot;)
data &lt;- list(data_1 = data.frame(X=0:1, Y=0:1), 
             data_2 = data.frame(X=0:1, Y=1:0))

results &lt;-
future.apply::future_lapply(
  data,
  function(d) {
    update_model(
      model = model,
      data = d,
      chains = chains,
      refresh = 0
    )},
 future.seed = TRUE)
</code></pre>
<pre><code>S4 class stanmodel 'simplexes' coded as follows:
functions{
  row_vector col_sums(matrix X) {
    row_vector[cols(X)] s ;
    s = rep_row_vector(1, rows(X)) * X ;
    return s ;
  }
}
data {
int&lt;lower=1&gt; n_params;
int&lt;lower=1&gt; n_paths;
int&lt;lower=1&gt; n_types;
int&lt;lower=1&gt; n_param_sets;
int&lt;lower=1&gt; n_nodes;
array[n_param_sets] int&lt;lower=1&gt; n_param_each;
int&lt;lower=1&gt; n_data;
int&lt;lower=1&gt; n_events;
int&lt;lower=1&gt; n_strategies;
int&lt;lower=0, upper=1&gt; keep_type_distribution;
vector&lt;lower=0&gt;[n_params] lambdas_prior;
array[n_param_sets] int&lt;lower=1&gt; l_starts;
array[n_param_sets] int&lt;lower=1&gt; l_ends;
array[n_nodes] int&lt;lower=1&gt; node_starts;
array[n_nodes] int&lt;lower=1&gt; node_ends;
array[n_strategies] int&lt;lower=1&gt; strategy_starts;
array[n_strategies] int&lt;lower=1&gt; strategy_ends;
matrix[n_params, n_types] P;
matrix[n_params, n_paths] parmap;
matrix[n_paths, n_data] map;
matrix&lt;lower=0,upper=1&gt;[n_events,n_data] E;
array[n_events] int&lt;lower=0&gt; Y;
}
parameters {
vector&lt;lower=0&gt;[n_params - n_param_sets] gamma;
}
transformed parameters {
vector&lt;lower=0, upper=1&gt;[n_params] lambdas;
vector&lt;lower=1&gt;[n_param_sets] sum_gammas;
matrix[n_params, n_paths] parlam;
matrix[n_nodes, n_paths] parlam2;
vector&lt;lower=0, upper=1&gt;[n_paths] w_0;
vector&lt;lower=0, upper=1&gt;[n_data] w;
vector&lt;lower=0, upper=1&gt;[n_events] w_full;
// Cases in which a parameter set has only one value need special handling
// they have no gamma components and sum_gamma needs to be made manually
for (i in 1:n_param_sets) {
  if (l_starts[i] &gt;= l_ends[i]) {
    sum_gammas[i] = 1;
    lambdas[l_starts[i]] = 1;
    }
  else if (l_starts[i] &lt; l_ends[i]) {
    sum_gammas[i] =
    1 + sum(gamma[(l_starts[i] - (i-1)):(l_ends[i] - i)]);
    lambdas[l_starts[i]:l_ends[i]] =
    append_row(1, gamma[(l_starts[i] - (i-1)):(l_ends[i] - i)]) /
      sum_gammas[i];
    }
  }
// Mapping from parameters to data types
// (usual case): [n_par * n_data] * [n_par * n_data]
parlam  = rep_matrix(lambdas, n_paths) .* parmap;
// Sum probability over nodes on each path
for (i in 1:n_nodes) {
 parlam2[i,] = col_sums(parlam[(node_starts[i]):(node_ends[i]),]);
 }
// then take product  to get probability of data type on path
for (i in 1:n_paths) {
  w_0[i] = prod(parlam2[,i]);
 }
 // last (if confounding): map to n_data columns instead of n_paths
 w = map'*w_0;
  // Extend/reduce to cover all observed data types
 w_full = E * w;
}
model {
// Dirichlet distributions
for (i in 1:n_param_sets) {
  target += dirichlet_lpdf(lambdas[l_starts[i]:l_ends[i]]  |
    lambdas_prior[l_starts[i] :l_ends[i]]);
  target += -n_param_each[i] * log(sum_gammas[i]);
 }
// Multinomials
// Note with censoring event_probabilities might not sum to 1
for (i in 1:n_strategies) {
  target += multinomial_lpmf(
  Y[strategy_starts[i]:strategy_ends[i]] |
    w_full[strategy_starts[i]:strategy_ends[i]]/
     sum(w_full[strategy_starts[i]:strategy_ends[i]]));
 }
}
// Option to export distribution of causal types
generated quantities{
vector[n_types] types;
if (keep_type_distribution == 1){
for (i in 1:n_types) {
   types[i] = prod(P[, i].*lambdas + 1 - P[,i]);
}}
 if (keep_type_distribution == 0){
    types = rep_vector(1, n_types);
 }
} 
</code></pre>
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</body>
</html>
