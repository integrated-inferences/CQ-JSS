<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Replication code for ‘Making, Updating, and Querying Causal Models using CausalQueries’</title>
<style type="text/css">
/**
 * Prism.s theme ported from highlight.js's xcode style
 */
pre code {
  padding: 1em;
}
.token.comment {
  color: #007400;
}
.token.punctuation {
  color: #999;
}
.token.tag,
.token.selector {
  color: #aa0d91;
}
.token.boolean,
.token.number,
.token.constant,
.token.symbol {
  color: #1c00cf;
}
.token.property,
.token.attr-name,
.token.string,
.token.char,
.token.builtin {
  color: #c41a16;
}
.token.inserted {
  background-color: #ccffd8;
}
.token.deleted {
  background-color: #ffebe9;
}
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
  color: #9a6e3a;
}
.token.atrule,
.token.attr-value,
.token.keyword {
  color: #836c28;
}
.token.function,
.token.class-name {
  color: #DD4A68;
}
.token.regex,
.token.important,
.token.variable {
  color: #5c2699;
}
.token.important,
.token.bold {
  font-weight: bold;
}
.token.italic {
  font-style: italic;
}
</style>
<style type="text/css">
body {
  font-family: sans-serif;
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 1.5;
  box-sizing: border-box;
}
body, .footnotes, code { font-size: .9em; }
li li { font-size: .95em; }
*, *:before, *:after {
  box-sizing: inherit;
}
pre, img { max-width: 100%; }
pre, pre:hover {
  white-space: pre-wrap;
  word-break: break-all;
}
pre code {
  display: block;
  overflow-x: auto;
}
code { font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace; }
:not(pre) > code, code[class] { background-color: #F8F8F8; }
code.language-undefined, pre > code:not([class]) {
  background-color: inherit;
  border: 1px solid #eee;
}
table {
  margin: auto;
  border-top: 1px solid #666;
}
table thead th { border-bottom: 1px solid #ddd; }
th, td { padding: 5px; }
thead, tfoot, tr:nth-child(even) { background: #eee; }
blockquote {
  color: #666;
  margin: 0;
  padding-left: 1em;
  border-left: 0.5em solid #eee;
}
hr, .footnotes::before { border: 1px dashed #ddd; }
.frontmatter { text-align: center; }
#TOC .numbered li { list-style: none; }
#TOC .numbered { padding-left: 0; }
#TOC .numbered ul { padding-left: 1em; }
table, .body h2 { border-bottom: 1px solid #666; }
.body .appendix, .appendix ~ h2 { border-bottom-style: dashed; }
.footnote-ref a::before { content: "["; }
.footnote-ref a::after { content: "]"; }
section.footnotes::before {
  content: "";
  display: block;
  max-width: 20em;
}

@media print {
  body {
    font-size: 12pt;
    max-width: 100%;
  }
  tr, img { page-break-inside: avoid; }
}
@media only screen and (min-width: 992px) {
  pre { white-space: pre; }
}
</style>
<script>
$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<link href="C:\Users\humphreys\AppData\Local\R\win-library\4.4\kableExtra\lightable-0.0.1\lightable.css" rel="stylesheet" />
</head>
<body>
<div class="frontmatter">
<div class="title"><h1>Replication code for ‘Making, Updating, and Querying Causal Models using CausalQueries’</h1></div>
<div class="author"><h2>Till Tietz, Lily Medina, Georgiy Syunyaev, and Macartan Humphreys</h2></div>
<div class="date"><h3>November 2024</h3></div>
</div>
<div class="body">
<p>Generated by <code>knitr::spin()</code> from <code>code.R</code>.</p>
<h2 id="set-up">Set up</h2>
<pre><code class="language-r">library(tidyverse)
library(CausalQueries)
library(microbenchmark)
library(parallel)
library(future)
library(future.apply)
library(knitr)
library(rstan)

options(kableExtra.latex.load_packages = FALSE)
library(kableExtra)
options(mc.cores = parallel::detectCores())

set.seed(1, &quot;L'Ecuyer-CMRG&quot;)
theme_set(theme_bw())
</code></pre>
<h2 id="data-import">Data import</h2>
<pre><code class="language-r">data(&quot;lipids_data&quot;)

lipids_data
</code></pre>
<pre><code>##    event strategy count
## 1 Z0X0Y0      ZXY   158
## 2 Z1X0Y0      ZXY    52
## 3 Z0X1Y0      ZXY     0
## 4 Z1X1Y0      ZXY    23
## 5 Z0X0Y1      ZXY    14
## 6 Z1X0Y1      ZXY    12
## 7 Z0X1Y1      ZXY     0
## 8 Z1X1Y1      ZXY    78
</code></pre>
<h2 id="lipids-model">Lipids model</h2>
<pre><code class="language-r">lipids_model &lt;-  make_model(&quot;Z -&gt; X -&gt; Y; X &lt;-&gt; Y&quot;) 
</code></pre>
<pre><code class="language-r">lipids_model &lt;- update_model(lipids_model, lipids_data)
</code></pre>
<pre><code class="language-r">lipids_queries &lt;-
  query_model(
    lipids_model,
    query = &quot;Y[X=1] - Y[X=0]&quot;,
    given = c(&quot;All&quot;, &quot;X==0 &amp; Y==0&quot;, &quot;X[Z=1] &gt; X[Z=0]&quot;),
    using = &quot;posteriors&quot;
  )
</code></pre>
<pre><code class="language-r">lipids_queries |&gt;
  dplyr::select(query, given, mean, sd, starts_with(&quot;cred&quot;)) |&gt;
  knitr::kable(
    digits = 2,
    booktabs = TRUE,
    align = &quot;c&quot;,
    escape = TRUE, 
    linesep = &quot;&quot;) 
</code></pre>
<table>
<thead>
<tr>
<th align="center">query</th>
<th align="center">given</th>
<th align="center">mean</th>
<th align="center">sd</th>
<th align="center">cred.low</th>
<th align="center">cred.high</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Y[X=1] - Y[X=0]</td>
<td align="center">-</td>
<td align="center">0.55</td>
<td align="center">0.10</td>
<td align="center">0.37</td>
<td align="center">0.73</td>
</tr>
<tr>
<td align="center">Y[X=1] - Y[X=0]</td>
<td align="center">X==0 &amp; Y==0</td>
<td align="center">0.64</td>
<td align="center">0.15</td>
<td align="center">0.37</td>
<td align="center">0.89</td>
</tr>
<tr>
<td align="center">Y[X=1] - Y[X=0]</td>
<td align="center">X[Z=1] &gt; X[Z=0]</td>
<td align="center">0.70</td>
<td align="center">0.05</td>
<td align="center">0.59</td>
<td align="center">0.80</td>
</tr>
</tbody>
</table>
<pre><code class="language-r">lipids_queries |&gt; plot()
</code></pre>
<p><img src="data:image/png;base64,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" alt="Illustration of queries plotted" /></p>
<p>All in a single pipe:</p>
<pre><code class="language-r">  make_model(&quot;Z -&gt; X -&gt; Y; X &lt;-&gt; Y&quot;) |&gt;
  update_model(lipids_data) |&gt;
  query_model(
    query = &quot;Y[X=1] - Y[X=0]&quot;,
    given = c(&quot;All&quot;, &quot;X==0 &amp; Y==0&quot;, &quot;X[Z=1] &gt; X[Z=0]&quot;),
    using = &quot;posteriors&quot;
  ) |&gt;
  plot()
</code></pre>
<p><img src="data:image/png;base64,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lywAHd3ZaGyY70XSXpxQdelVleJ3FN8rtCcpAHVnoyACIPUurLHhvxVLeXFCf+WMw79vT+6oM1wQIaZXaE9CANKrwCWqS2aX0QjknjLfzKa7OKFB4/hezI46wzU1pnuN9zS9YmGWynrtwWRimwON3oSlujhhL7SS7uSO/EFouldoT0JGIPGnsIhSXZzQdNFTm8kdjUag6V6/yAMoYVthAIp8DpTq4oRq62gmHtlRMAeK6SVvDiQeICN3+ElSqosT/q+mtitdnbGjuF6hPeUKoGLa8QEU+UIsrcUJY7ostiMAlJIdH0D982GAUlqccLrLYjvK4+dAxbSbBdCceb3Rb6NfS7szv+SYmAPl8jetAIhYNgOgeR9NaQ3+ssDP7fFdWIptebWLASjyUVOw0b14bqV5dMc5ta+Gk5Vm2ymp+1P77vMr/66YzerRl+vRb9wnRqBcfh8PgIhli57CXIVIpV3x2pX2hnf0sxqB1L1bcUvecLN6ZFpCNeMRSPXw3Fz+rBUAEcsWnUSrmU7/0hd1daOGk6fqCqCGGlJKarNbMZvVI9MSqon+IjGfP0sEQMSyhQEaDTX6ScUfgQxXwQhk5siRGXX4uzAzhi3oxSkARCxbGKDnneEcqO2YRyXzKzMDkD8HqnhtZ8YcyEyCcskPAKKWWZzCrIV3YSm25dUOAElLlNkOV+eQliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQCSliizHQAKvx5T14UsYKK+unPaUrUDQACIZAeAABDJrrAApbJ0XTYAJVrcCwClrTSWrssEoDnX4AZAES35FEZfum5qwbkM1nxbllJYSy5HC84tR/Sl63AKI9sVGSD60nWYRJPtJACUfOk6AES2EwAQYek6AES2KzJARqSl6/BVBrms+ADRlq4DQMSywgNEFAAilgEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2wEgaYky2z3xAEFELTGcIgB0ghK+PElfVdl21gJAsCNJAEBQlgJAEEkACCIJAEEkFRkg/yJCWqNLD9mUqfsXt0/qHF93NYHd8PJsXHaHbwcvznJVZID8y5h5+kWzeYmDssMPktl1NmOubrTAUXreN7vzu8bWjS/1Z3uUPYuyxCoyQP6FFJU6b75rAVBQdvA3q//ao7pv3rOqGx1l3CW0FqizBCgoC1+Ye5kqMkAPAhLMZYKty/RFGT9MYKf+g9ug8GAEkNUANK7rWJ35gjJ1CnvpDRu/hCoyQKP/bHazi/GQYDcmjEagXau6kd2BXZ6jf11N/7G3sx3xEqrIAI1nF4c2I1DSWULCutFRWuYZtrM4F4XKdjAHmi/zhsOwYwVQUDZ+E2ddZ/22SB+gzUwmVKfORVcszn1J/3VJVWSAoBwIAEEkASCIJAAEkQSAIJIAEEQSACKrf2E/60PIUACILAAEWatdMX/bjlNSAP10Yf/o47rn6mdPmgBQIvUNMup28GozAEiPRI2NrI+MWwAomb6o9y8pjs45T9UDgNQA5DiVrA+MWwAomdySGmzclebgug+QunefvPOXB4CSanDzZlNR5LlmBDrf7D9XV3+O7uAUBi2mhhpvBuvOM+sbau7TcJ6+gUk0BNkLAEEkASCIJAAEkQSAIJIAEEQSAIJI+h3P1IK4kHC0UgAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-8" /></p>
<h2 id="making-models">Making models</h2>
<pre><code class="language-r">with_pars &lt;- 
  lipids_model |&gt;
  set_parameters(param_type = &quot;prior_draw&quot;) 

with_pars$parameters_df |&gt;
  dplyr::select(node,  nodal_type, param_set, param_names, param_value, priors) |&gt; 
  knitr::kable(
    digits = 2,
    booktabs = TRUE,
    align = &quot;c&quot;,
    escape = TRUE,
    longtable = TRUE,
    linesep = &quot;&quot;) |&gt; 
  kableExtra::kable_classic_2(latex_options = c(&quot;hold_position&quot;))
</code></pre>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:center;"> node </th>
   <th style="text-align:center;"> nodal_type </th>
   <th style="text-align:center;"> param_set </th>
   <th style="text-align:center;"> param_names </th>
   <th style="text-align:center;"> param_value </th>
   <th style="text-align:center;"> priors </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> 0 </td>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> Z.0 </td>
   <td style="text-align:center;"> 0.84 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> 1 </td>
   <td style="text-align:center;"> Z </td>
   <td style="text-align:center;"> Z.1 </td>
   <td style="text-align:center;"> 0.16 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.00 </td>
   <td style="text-align:center;"> 0.12 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.10 </td>
   <td style="text-align:center;"> 0.08 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.01 </td>
   <td style="text-align:center;"> 0.11 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> X </td>
   <td style="text-align:center;"> X.11 </td>
   <td style="text-align:center;"> 0.69 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.00_X.00 </td>
   <td style="text-align:center;"> 0.38 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.10_X.00 </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.01_X.00 </td>
   <td style="text-align:center;"> 0.20 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.00 </td>
   <td style="text-align:center;"> Y.11_X.00 </td>
   <td style="text-align:center;"> 0.42 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.00_X.01 </td>
   <td style="text-align:center;"> 0.40 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.10_X.01 </td>
   <td style="text-align:center;"> 0.38 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.01_X.01 </td>
   <td style="text-align:center;"> 0.06 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.01 </td>
   <td style="text-align:center;"> Y.11_X.01 </td>
   <td style="text-align:center;"> 0.16 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.00_X.10 </td>
   <td style="text-align:center;"> 0.71 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.10_X.10 </td>
   <td style="text-align:center;"> 0.15 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.01_X.10 </td>
   <td style="text-align:center;"> 0.05 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.10 </td>
   <td style="text-align:center;"> Y.11_X.10 </td>
   <td style="text-align:center;"> 0.09 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 00 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.00_X.11 </td>
   <td style="text-align:center;"> 0.65 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 10 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.10_X.11 </td>
   <td style="text-align:center;"> 0.04 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 01 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.01_X.11 </td>
   <td style="text-align:center;"> 0.01 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Y </td>
   <td style="text-align:center;"> 11 </td>
   <td style="text-align:center;"> Y.X.11 </td>
   <td style="text-align:center;"> Y.11_X.11 </td>
   <td style="text-align:center;"> 0.30 </td>
   <td style="text-align:center;"> 1 </td>
  </tr>
</tbody>
</table>
<pre><code class="language-r">model &lt;- make_model(&quot;X -&gt; M -&gt; Y &lt;- X&quot;)
</code></pre>
<pre><code class="language-r">lipids_model |&gt; plot()

lipids_model |&gt;
  plot(x_coord = 1:3,
       y_coord = 3:1,
       textcol = &quot;black&quot;,
       textsize = 3,
       shape = c(15, 16, 16),
       nodecol = &quot;lightgrey&quot;,
       nodesize = 10)
</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt="Examples of model graphs." width="50%" /><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAGwCAMAAAA+O0jxAAAAWlBMVEUAAAAAADAAMHcAVZYwMDAwMHcwVZYwd7VVADBVAFVVMHdVVVVVltN3MAB3MDB3MFV3tdOWVQCWVTCW07WW09O1dzC105a109PTllXTtXfT05bT07XT09P///+tl+dgAAAACXBIWXMAAAsSAAALEgHS3X78AAAHPklEQVR4nO3c63bTVhRFYbUpTS8JhBZKLuL9X7M4MY5lyVq6nNvee84fMGoc66xvGDeAk+47zdbVPkDrASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEP4D6yWofrJUAEgEkAkgEkAggEUAigEQAic6AHrsf3QA0bPgMev7jAaBhA6CX+zt+i100APp8y2vQZedAX296gC47f5E+9wHo2DvQy/3h/2K/fgNoEJ8HiQASASQCSASQCCAR/+wjAkgEkAggEUAigEQAiQASXQeC7rUZBoQOASSaU0DoO0CyWQSElAFCigAhJRBeCCCRBIgupPcHF1owP7YQQKIl60MLASRaND6y0LLtgYUWTo8rBJBo6fKwQgCJFg+PKrR8d1ChFbNjCgEkWrM6pBBAolWjIwqt2xxQaOXkeEIAidYuDicEkGj14GhC6/cGE9owN5YQQKIta0MJASTaNDaS0LatgYQ2To0jtHVpGCGARJuHRhHavjOI0I6ZMYQAEu1ZGUIIINGukRGE9m0MILRzon8hgER7F7oXAki0e6B3IYBE+/c5F0owz7dQinWuhQASJRnnWQggUZptjoUSTfMrlGqZWyGARMmGeRUCSJRul1OhhLN8CqVc5VIIIFHSUR6FABKl3eRQKPGkzh1R6kEAFX/AygEkSr/HmVCGOb6EcqxxJQSQKMsYT0IAifJscSSUaYofoVxL3AgBJMo2xIsQQKJ8O5wIZZzhQyjnChdCAImyjvAgBJAo7wYHQpkn2BfKvcC8EECi7AOsCwEkyn9+40IFjm9bqMTpTQsBJCpyeMtCAInKnN2wUKGj231rXqmDA9TMhRIHkKjcuY0KASQqeGybQiVPbVKo6KEtCgEkKntmg0IAiQof2Z5Q6RObEyp+YGtCAInKn9eYEECiCse1JVTjtKaEqhzWkhBAojpnNSQEkKjSUe0I1TqpGaFqB7UiBJCo3jmNCAEkqnhMG0I1T9nVP4Ku6ukOF+8af+tQbaAOoNmrdwDNXhyg2Ut3AM1euTMh1MIzCKCrFwdIXh4geQCA5BEaOMP1mj5cCwEkAkgEkAggEUAigERtAfWv1T7FoJaA+lO1T3JWQ0B936JQM0D9RbXP8zOARK0AXfo0I9QI0NinFSGARG0ATfk0ItQW0Ne7/vEGoHE/SV4+/fvpC0DjTiaPv93xW2yik8nzn18Amuhk8vXvW4CmOpI8/d7/89CUT1tALx8f+qcP3wCaqNHPgtoB4g+rKoBkLfI0BcRfuequ8DTwZu7Gq/gGEBtAfFVSu5kC4ov8VRVei2wBVQggUdNAVw7Hd+47dU2I7x967Orp+Ba0x+ofr/4JZqt/vPonmG/2fCUO3zpQdaHmgWoLGQdyf/klqSPmneAAKO/njQaAFpwx4woLQFWFTADxPWpUAKmWHDPPFEdAebYYAaonZAWIb/goW3jS1IPcAaVeZAeo0lPIH5CLq26rylktAS0/bMJVpoBWCCXbZQuownPIK5DhK+6r+HmtARU/sDmgFSdOss0zUJJx9oAKC/kGMne1NPEOM9WaQ+8daBKo5MuQe6C9C20C8R5FFUCqYucOAbRnpFWgYkJmgUoJ2QUqdHSAmrhKnoqcHaAWLpKrEq/TpoFKCNkGKvCn1kBArV4hb9nPD1DtC+Qu9wDzQLlfp+0DZRYCKPlHtFfWDQDVfPBSRf+KQ13GL8r0AZTxn1qdAOV7W1U8oJWTvQBlewq5Acq1xA9QpikAVXnUOmXZEhOo8FuJmynHl7q4Asoh5Ato8RyAGn7EuiXfA1DpB6xd6kHugJYuSv9ybqZlkwAqezdTJd0EUMkHa6WUo1wCpVzlE2jZrHR3shdAqmTjQwMVfaDWSjXMLVCqZX6BEk2LDZTmLmbT2wDafxfPQEnGuQZK8dY830AJ5jkH2r8vPJC6g3eg3QAA7fx1+4mFAO2cGABo30aAcn6wlfaMBGjXr3ppdiVA3+dnAnRosxBAuT7QWluHApTp4+w1s3T7S7irrk8F6K2rWwF6CyDVlrEAZfgYu21YGwtow9xgQNf2bvsUwGMAqdYKAZT4/vZbuTge0MrJAYHWbQZo7saZ2103NRqg8yZWAzRoPBugYYt3A5Tqjt5aOhygRPfz12j5NEVcoNF0gC7rZv9z9tYYLXoKRQZaNB6gBPfxW/CvOFxQN/hp5h5hO+zvuhkngA4+AF2v696B1vw9UZS6AdDUHcqdpcU6gObq3rt+n4Lnaa0OIBVAOoBkAOkA2h5AIoBEAIkAEgEkAkgE0LD+tbMbADqvP3W6CaCz+n4sBNCp/qK3WwE6BdB8lz5HIYCOjX3ehAA6BtB8Uz6vQgC99Qbycn/748fPtwCNOoq8fHzoH294Bo37SfL04b+/vgE07mTy+MsDr0ETnUyez55AAJ01BXS4HaBjAKmmP08E6L1JH4DeA0g25gFo2NgHoIsueACSASQCSASQCCARQCKARACJABL9D4azy+8mOe05AAAAAElFTkSuQmCC" alt="Examples of model graphs." width="50%" />
<p class="caption">Examples of model graphs.</p>
</div>
<pre><code class="language-r">statements &lt;- list(&quot;X -&gt; Y &lt;- W&quot;, 
                   &quot;X -&gt; Y &lt;- W; X &lt;-&gt; W&quot;, 
                   &quot;X -&gt; Y &lt;- W; X &lt;-&gt; Y; W &lt;-&gt; Y&quot;,
                   &quot;X -&gt; Y &lt;- W; X &lt;-&gt; Y; W &lt;-&gt; Y; X &lt;-&gt; W&quot;, 
                   &quot;X -&gt; W -&gt; Y &lt;- X&quot;,
                   &quot;X -&gt; W -&gt; Y &lt;- X; W &lt;-&gt; Y&quot;,
                   &quot;X -&gt; W -&gt; Y &lt;- X; X &lt;-&gt; W; W &lt;-&gt; Y&quot;, 
                   &quot;X -&gt; W -&gt; Y &lt;- X; X &lt;-&gt; W; W &lt;-&gt; Y; X &lt;-&gt; Y&quot;)

dof &lt;- function(statement) {
  make_model(statement, add_causal_types = FALSE) |&gt;
  grab(&quot;parameters_df&quot;)  |&gt;
  group_by(param_set) |&gt;
  summarize(n  = n() - 1) |&gt;
  pull(n) |&gt;
  sum()
}
  

statements |&gt; 
  lapply(function(s) paste0(&quot;`&quot;, s, &quot;`&quot;)) |&gt; 
  unlist() |&gt; 
  data.frame(
    Model = _,
    dof = unlist(lapply(statements, dof))) |&gt;
  knitr::kable(
    digits = 2,
    booktabs = TRUE,
    align = c(&quot;l&quot;, &quot;c&quot;),
    escape = TRUE, 
    linesep = &quot;&quot;,
    col.names = c(&quot;Model&quot;, &quot;Degrees of freedom&quot;)) 
</code></pre>
<table>
<thead>
<tr>
<th align="left">Model</th>
<th align="center">Degrees of freedom</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W</code></td>
<td align="center">17</td>
</tr>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W; X &lt;-&gt; W</code></td>
<td align="center">18</td>
</tr>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W; X &lt;-&gt; Y; W &lt;-&gt; Y</code></td>
<td align="center">62</td>
</tr>
<tr>
<td align="left"><code>X -&gt; Y &lt;- W; X &lt;-&gt; Y; W &lt;-&gt; Y; X &lt;-&gt; W</code></td>
<td align="center">63</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X</code></td>
<td align="center">19</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X; W &lt;-&gt; Y</code></td>
<td align="center">64</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X; X &lt;-&gt; W; W &lt;-&gt; Y</code></td>
<td align="center">67</td>
</tr>
<tr>
<td align="left"><code>X -&gt; W -&gt; Y &lt;- X; X &lt;-&gt; W; W &lt;-&gt; Y; X &lt;-&gt; Y</code></td>
<td align="center">127</td>
</tr>
</tbody>
</table>
<h2 id="tailoring-models">Tailoring models</h2>
<pre><code class="language-r">model_restricted &lt;- 
  lipids_model |&gt; 
  set_restrictions(&quot;X[Z=1] &lt; X[Z=0]&quot;)
</code></pre>
<pre><code class="language-r">model &lt;- 
  lipids_model |&gt;
  set_restrictions(labels = list(X = &quot;01&quot;, Y = c(&quot;00&quot;, &quot;01&quot;, &quot;11&quot;)), 
                   keep = TRUE)
</code></pre>
<pre><code class="language-r">model &lt;- lipids_model |&gt;
  set_restrictions(labels = list(Y = &quot;?0&quot;))
</code></pre>
<pre><code class="language-r">model &lt;- lipids_model |&gt;
  set_restrictions(labels = list(Y = c('00', '11')), given = 'X.00')
</code></pre>
<pre><code class="language-r">lipids_model |&gt; 
  inspect(&quot;prior_hyperparameters&quot;, nodes = &quot;X&quot;) 
</code></pre>
<pre><code>## 
## prior_hyperparameters
## Alpha parameter values used for Dirichlet prior distributions:
## 
## X.00 X.10 X.01 X.11 
##    1    1    1    1
</code></pre>
<pre><code class="language-r">model &lt;- lipids_model |&gt; 
  set_priors(distribution = &quot;jeffreys&quot;)
</code></pre>
<pre><code>## Altering all parameters.
</code></pre>
<pre><code class="language-r">lipids_model |&gt; 
  set_priors(param_names = c(&quot;X.10&quot;, &quot;X.01&quot;), alphas = 3:4) |&gt; 
  inspect(&quot;prior_hyperparameters&quot;, nodes = &quot;X&quot;)
</code></pre>
<pre><code>## 
## prior_hyperparameters
## Alpha parameter values used for Dirichlet prior distributions:
## 
## X.00 X.10 X.01 X.11 
##    1    3    4    1
</code></pre>
<pre><code class="language-r">lipids_model |&gt;
  set_priors(statement = &quot;X[Z=1] &gt; X[Z=0]&quot;, alphas = 3) |&gt;
  inspect(&quot;prior_hyperparameters&quot;, nodes = &quot;X&quot;)
</code></pre>
<pre><code>## 
## prior_hyperparameters
## Alpha parameter values used for Dirichlet prior distributions:
## 
## X.00 X.10 X.01 X.11 
##    1    1    3    1
</code></pre>
<pre><code class="language-r">query &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt;
  set_restrictions(decreasing(&quot;X&quot;, &quot;Y&quot;)) |&gt;
  query_model(&quot;Y[X=1] - Y[X=0]&quot;, using = &quot;priors&quot;)
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  inspect(&quot;parameters&quot;)
</code></pre>
<pre><code>## 
## parameters
## Model parameters with associated probabilities: 
## 
##  X.0  X.1 Y.00 Y.10 Y.01 Y.11 
## 0.50 0.50 0.25 0.25 0.25 0.25
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt;
  set_parameters(statement = &quot;Y[X=1] &gt; Y[X=0]&quot;, parameters = .7) |&gt;
  inspect(&quot;parameters&quot;)
</code></pre>
<pre><code>## 
## parameters
## Model parameters with associated probabilities: 
## 
##  X.0  X.1 Y.00 Y.10 Y.01 Y.11 
##  0.5  0.5  0.1  0.1  0.7  0.1
</code></pre>
<pre><code class="language-r">lipids_model |&gt; 
  make_data(n = 4)
</code></pre>
<pre><code>##   Z X Y
## 1 0 0 0
## 2 0 0 1
## 3 1 1 0
## 4 1 1 1
</code></pre>
<pre><code class="language-r">sample_data &lt;-
  lipids_model |&gt;
  make_data(n = 8,
            nodes = list(c(&quot;Z&quot;, &quot;Y&quot;), &quot;X&quot;),
            probs = list(1, .5),
            subsets = list(TRUE, &quot;Z==1 &amp; Y==0&quot;))
</code></pre>
<pre><code class="language-r">sample_data |&gt; 
  collapse_data(lipids_model)
</code></pre>
<pre><code>##     event strategy count
## 1  Z0X0Y0      ZXY     0
## 2  Z1X0Y0      ZXY     1
## 3  Z0X1Y0      ZXY     0
## 4  Z1X1Y0      ZXY     1
## 5  Z0X0Y1      ZXY     0
## 6  Z1X0Y1      ZXY     0
## 7  Z0X1Y1      ZXY     0
## 8  Z1X1Y1      ZXY     0
## 9    Z0Y0       ZY     1
## 10   Z1Y0       ZY     2
## 11   Z0Y1       ZY     1
## 12   Z1Y1       ZY     2
</code></pre>
<h2 id="updating-models">Updating models</h2>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  inspect(&quot;parameter_mapping&quot;) 
</code></pre>
<pre><code>## 
## parameter_mapping (Parameter mapping matrix) 
## 
##   Maps from parameters to data types, with
##   possibly multiple columns for each data type
##   in cases with confounding. 
## 
##      X0Y0 X1Y0 X0Y1 X1Y1
## X.0     1    0    1    0
## X.1     0    1    0    1
## Y.00    1    1    0    0
## Y.10    0    1    1    0
## Y.01    1    0    0    1
## Y.11    0    0    1    1
</code></pre>
<pre><code class="language-r">data &lt;- data.frame(X = rep(0:1, 5), Y = rep(0:1, 5))

list(
  uncensored = 
    update_model(make_model(&quot;X -&gt; Y&quot;),
                 data),
  censored = 
    update_model(make_model(&quot;X -&gt; Y&quot;), 
                 data, 
                 censored_types = c(&quot;X1Y0&quot;,  &quot;X0Y1&quot;))
  ) |&gt;
  query_model(&quot;Y[X=1] - Y[X=0]&quot;, using = &quot;posteriors&quot;) |&gt; 
  subset(select = c(&quot;model&quot;, &quot;query&quot;, &quot;mean&quot;, &quot;sd&quot;))
</code></pre>
<pre><code>## 
## Causal queries generated by query_model
## 
## |model      |query           |  mean|    sd|
## |:----------|:---------------|-----:|-----:|
## |uncensored |Y[X=1] - Y[X=0] | 0.590| 0.194|
## |censored   |Y[X=1] - Y[X=0] | 0.018| 0.315|
</code></pre>
<pre><code class="language-r">model &lt;-
  make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  update_model()
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code class="language-r">posterior &lt;- inspect(model, &quot;posterior_distribution&quot;)  
</code></pre>
<pre><code>## 
## posterior_distribution
## Summary statistics of model parameters posterior distributions:
## 
##   Distributions matrix dimensions are 
##   4000 rows (draws) by 6 cols (parameters)
## 
##      mean   sd
## X.0  0.51 0.28
## X.1  0.49 0.28
## Y.00 0.25 0.19
## Y.10 0.25 0.19
## Y.01 0.25 0.19
## Y.11 0.25 0.20
</code></pre>
<pre><code class="language-r">lipids_model &lt;- 
  lipids_model |&gt; 
  update_model(keep_fit = TRUE,
               keep_event_probabilities = TRUE)
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  update_model(keep_type_distribution = FALSE) |&gt;
  inspect(&quot;stan_summary&quot;) 
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code>## 
## stan_summary
## Stan model summary:
## 
## Inference for Stan model: simplexes.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##             mean se_mean   sd   2.5%   25%   50%   75% 97.5% n_eff Rhat
## X.0         0.50    0.01 0.29   0.03  0.25  0.49  0.74  0.97  3036    1
## X.1         0.50    0.01 0.29   0.03  0.26  0.51  0.75  0.97  3036    1
## Y.00        0.25    0.00 0.19   0.01  0.09  0.21  0.37  0.70  2031    1
## Y.10        0.25    0.00 0.19   0.01  0.09  0.21  0.37  0.71  4633    1
## Y.01        0.25    0.00 0.20   0.01  0.09  0.20  0.37  0.72  4162    1
## Y.11        0.25    0.00 0.20   0.01  0.09  0.20  0.37  0.71  4701    1
## lp__       -7.53    0.04 1.65 -11.75 -8.37 -7.15 -6.32 -5.44  1368    1
## 
## Samples were drawn using NUTS(diag_e) at Mon Nov 11 16:34:01 2024.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).
</code></pre>
<pre><code class="language-r">model &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt; 
  update_model(refresh = 0, keep_fit = TRUE)
</code></pre>
<pre><code>## No data provided
</code></pre>
<pre><code class="language-r">model |&gt; 
  inspect(&quot;stanfit&quot;)
</code></pre>
<pre><code>## 
## stanfit
## Stan model summary:
## Inference for Stan model: simplexes.
## 4 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=4000.
## 
##             mean se_mean   sd   2.5%   25%   50%   75% 97.5% n_eff Rhat
## lambdas[1]  0.50    0.01 0.29   0.03  0.25  0.49  0.74  0.97  2923    1
## lambdas[2]  0.50    0.01 0.29   0.03  0.26  0.51  0.75  0.97  2923    1
## lambdas[3]  0.25    0.00 0.20   0.01  0.09  0.20  0.37  0.73  1959    1
## lambdas[4]  0.25    0.00 0.19   0.01  0.09  0.20  0.37  0.70  4505    1
## lambdas[5]  0.25    0.00 0.19   0.01  0.09  0.21  0.38  0.70  4081    1
## lambdas[6]  0.25    0.00 0.19   0.01  0.09  0.21  0.36  0.72  4546    1
## types[1]    0.12    0.00 0.14   0.00  0.02  0.07  0.18  0.51  1916    1
## types[2]    0.13    0.00 0.14   0.00  0.03  0.08  0.18  0.51  2457    1
## types[3]    0.12    0.00 0.13   0.00  0.03  0.08  0.18  0.47  3783    1
## types[4]    0.13    0.00 0.13   0.00  0.03  0.08  0.18  0.48  3302    1
## types[5]    0.13    0.00 0.13   0.00  0.03  0.08  0.18  0.49  3538    1
## types[6]    0.13    0.00 0.13   0.00  0.03  0.08  0.18  0.50  3324    1
## types[7]    0.12    0.00 0.13   0.00  0.03  0.08  0.18  0.47  2941    1
## types[8]    0.13    0.00 0.13   0.00  0.03  0.08  0.18  0.51  3956    1
## lp__       -7.51    0.04 1.58 -11.43 -8.33 -7.20 -6.34 -5.42  1410    1
## 
## Samples were drawn using NUTS(diag_e) at Mon Nov 11 16:34:09 2024.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).
</code></pre>
<h2 id="querying-models">Querying models</h2>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  realise_outcomes()
</code></pre>
<pre><code>##      X Y
## 0.00 0 0
## 1.00 1 0
## 0.10 0 1
## 1.10 1 0
## 0.01 0 0
## 1.01 1 1
## 0.11 0 1
## 1.11 1 1
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  realise_outcomes(dos = list(X = 1))
</code></pre>
<pre><code>##      X Y
## 0.00 1 0
## 1.00 1 0
## 0.10 1 0
## 1.10 1 0
## 0.01 1 1
## 1.01 1 1
## 0.11 1 1
## 1.11 1 1
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  get_query_types(&quot;Y==1&quot;)
</code></pre>
<pre><code>## 
## Causal types satisfying query's condition(s)  
## 
##  query =  Y==1 
## 
## X0.Y10  X1.Y01
## X0.Y11  X1.Y11
## 
## 
##  Number of causal types that meet condition(s) =  4
##  Total number of causal types in model =  8
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;)  |&gt; 
  get_query_types(&quot;Y[X=1]==1&quot;)
</code></pre>
<pre><code>## 
## Causal types satisfying query's condition(s)  
## 
##  query =  Y[X=1]==1 
## 
## X0.Y01  X1.Y01
## X0.Y11  X1.Y11
## 
## 
##  Number of causal types that meet condition(s) =  4
##  Total number of causal types in model =  8
</code></pre>
<pre><code class="language-r">make_model(&quot;X1 -&gt; Y &lt;- X2&quot;)  |&gt;
  get_query_types(&quot;X1==1 &amp; X2==1 &amp; (Y[X1=1, X2=1] &gt; Y[X1=0, X2=0])&quot;)
</code></pre>
<pre><code>## 
## Causal types satisfying query's condition(s)  
## 
##  query =  X1==1&amp;X2==1&amp;(Y[X1=1,X2=1]&gt;Y[X1=0,X2=0]) 
## 
## X11.X21.Y0001  X11.X21.Y0101
## X11.X21.Y0011  X11.X21.Y0111
## 
## 
##  Number of causal types that meet condition(s) =  4
##  Total number of causal types in model =  64
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; Y&quot;) |&gt; 
  get_query_types(&quot;Y[X=1] - Y[X=0]&quot;)
</code></pre>
<pre><code>## X0.Y00 X1.Y00 X0.Y10 X1.Y10 X0.Y01 X1.Y01 X0.Y11 X1.Y11 
##      0      0     -1     -1      1      1      0      0
</code></pre>
<pre><code class="language-r">data  &lt;- data.frame(X = rep(0:1, 50), Y = rep(0:1, 50))

model &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt;
  update_model(data, iter  = 4000, refresh = 0)

model |&gt; 
  inspect(&quot;posterior_distribution&quot;)  |&gt; 
  ggplot(aes(Y.01 - Y.10)) + geom_histogram() 
</code></pre>
<pre><code>## 
## posterior_distribution
## Summary statistics of model parameters posterior distributions:
## 
##   Distributions matrix dimensions are 
##   8000 rows (draws) by 6 cols (parameters)
## 
##      mean   sd
## X.0  0.50 0.05
## X.1  0.50 0.05
## Y.00 0.02 0.02
## Y.10 0.01 0.01
## Y.01 0.95 0.03
## Y.11 0.02 0.02
</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Posterior on &quot;Probability $Y$ is increasing in $X$&quot;." width="60%" />
<p class="caption">Posterior on "Probability $Y$ is increasing in $X$".</p>
</div>
<pre><code class="language-r">queries &lt;- 
  make_model(&quot;X -&gt; Y&quot;) |&gt; 
  query_distribution(
    query = list(increasing = &quot;(Y[X=1] &gt; Y[X=0])&quot;,
                 ATE = &quot;(Y[X=1] - Y[X=0])&quot;), 
    using = &quot;priors&quot;)
</code></pre>
<pre><code class="language-r">lipids_model |&gt;
  query_model(
    query = &quot;Y[X=1] - Y[X=0]&quot;,
    given = &quot;X==1 &amp; Y==1 &amp; Z==1&quot;,
    using = &quot;posteriors&quot;)  |&gt; 
  subset(select = c(&quot;query&quot;, &quot;mean&quot;, &quot;sd&quot;))
</code></pre>
<pre><code>## 
## Causal queries generated by query_model
## 
## |query           |  mean|    sd|
## |:---------------|-----:|-----:|
## |Y[X=1] - Y[X=0] | 0.499| 0.238|
</code></pre>
<pre><code class="language-r">make_model(&quot;X -&gt; M -&gt; Y&quot;) |&gt;
  update_model(data.frame(X = rep(0:1, 8), Y = rep(0:1, 8)), iter = 4000) |&gt;
  query_model(&quot;Y[X=1] &gt; Y[X=0]&quot;, 
            given = &quot;X==1 &amp; Y==1 &amp; M==1&quot;, 
            using = &quot;posteriors&quot;,
            case_level = c(TRUE, FALSE))  |&gt; 
  subset(select = c(&quot;query&quot;, &quot;case_level&quot;, &quot;mean&quot;, &quot;sd&quot;))
</code></pre>
<pre><code>## 
## Causal queries generated by query_model
## 
## |query           |case_level |  mean|    sd|
## |:---------------|:----------|-----:|-----:|
## |Y[X=1] &gt; Y[X=0] |TRUE       | 0.672|    NA|
## |Y[X=1] &gt; Y[X=0] |FALSE      | 0.429| 0.326|
</code></pre>
<pre><code class="language-r">models &lt;- list(
  Unrestricted = lipids_model |&gt; 
    update_model(data = lipids_data, refresh = 0),
  Restricted = lipids_model |&gt; set_restrictions(&quot;X[Z=1] &lt; X[Z=0]&quot;) |&gt;
    update_model(data = lipids_data, refresh = 0))
</code></pre>
<pre><code class="language-r">queries &lt;- 
  query_model(
    models,  
    query = list(ATE = &quot;Y[X=1] - Y[X=0]&quot;, 
                 POS = &quot;Y[X=1] &gt; Y[X=0]&quot;),
    given = c(TRUE,  &quot;Y==1 &amp; X==1&quot;),
    case_level = c(FALSE, TRUE),
    using = c(&quot;priors&quot;, &quot;posteriors&quot;),
    expand_grid = TRUE)
</code></pre>
<pre><code class="language-r">queries |&gt;
  dplyr::select(-starts_with(&quot;cred&quot;)) |&gt; 
  knitr::kable(
    digits = 2,
    booktabs = TRUE,
    align = &quot;c&quot;,
    escape = TRUE,
    longtable = TRUE,
    linesep = &quot;&quot;) |&gt; 
  kableExtra::kable_classic_2(latex_options = c(&quot;hold_position&quot;))
</code></pre>
<table class=" lightable-classic-2" style='font-family: "Arial Narrow", "Source Sans Pro", sans-serif; margin-left: auto; margin-right: auto;'>
 <thead>
  <tr>
   <th style="text-align:center;"> model </th>
   <th style="text-align:center;"> query </th>
   <th style="text-align:center;"> given </th>
   <th style="text-align:center;"> using </th>
   <th style="text-align:center;"> case_level </th>
   <th style="text-align:center;"> mean </th>
   <th style="text-align:center;"> sd </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 0.20 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> 0.23 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.56 </td>
   <td style="text-align:center;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.56 </td>
   <td style="text-align:center;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.50 </td>
   <td style="text-align:center;"> 0.22 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.49 </td>
   <td style="text-align:center;"> 0.24 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.25 </td>
   <td style="text-align:center;"> 0.12 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.25 </td>
   <td style="text-align:center;"> 0.14 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.61 </td>
   <td style="text-align:center;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.61 </td>
   <td style="text-align:center;"> 0.10 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.50 </td>
   <td style="text-align:center;"> 0.22 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.49 </td>
   <td style="text-align:center;"> 0.24 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> FALSE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> 0.04 </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.00 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.56 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.56 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.50 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.49 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> ATE </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.25 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.25 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.61 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> - </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.61 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.50 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> priors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.49 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Unrestricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
  <tr>
   <td style="text-align:center;"> Restricted </td>
   <td style="text-align:center;"> POS </td>
   <td style="text-align:center;"> Y==1 &amp; X==1 </td>
   <td style="text-align:center;"> posteriors </td>
   <td style="text-align:center;"> TRUE </td>
   <td style="text-align:center;"> 0.95 </td>
   <td style="text-align:center;"> NA </td>
  </tr>
</tbody>
</table>
<pre><code class="language-r">queries |&gt; plot()
</code></pre>
<p><img src="data:image/png;base64,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" alt="Default plotting for a a set of queries over multiple models." /></p>
<h1 id="supplementary-material">Supplementary material</h1>
<h2 id="parallelization">Parallelization</h2>
<pre><code class="language-r">library(parallel)

options(mc.cores = parallel::detectCores())
</code></pre>
<pre><code class="language-r">library(future)
library(future.apply)

chains &lt;- 3
cores &lt;- 8

future::plan(list(
      future::tweak(future::multisession, 
                    workers = floor(cores/(chains + 1))),
      future::tweak(future::multisession, 
                    workers = chains)
    ))

model &lt;- make_model(&quot;X -&gt; Y&quot;)
data &lt;- list(data_1 = data.frame(X=0:1, Y=0:1), 
             data_2 = data.frame(X=0:1, Y=1:0))

results &lt;-
future.apply::future_lapply(
  data,
  function(d) {
    update_model(
      model = model,
      data = d,
      chains = chains,
      refresh = 0
    )},
 future.seed = TRUE)
</code></pre>
<p>sample output</p>
<pre><code class="language-r">results$data_1 |&gt; inspect(what = &quot;stan_summary&quot;)
</code></pre>
<pre><code>## 
## stan_summary
## Stan model summary:
## 
## Inference for Stan model: simplexes.
## 3 chains, each with iter=2000; warmup=1000; thin=1; 
## post-warmup draws per chain=1000, total post-warmup draws=3000.
## 
##             mean se_mean   sd   2.5%    25%   50%   75% 97.5% n_eff Rhat
## X.0         0.50    0.00 0.22   0.09   0.33  0.50  0.67  0.90  2013    1
## X.1         0.50    0.00 0.22   0.10   0.33  0.50  0.67  0.91  2013    1
## Y.00        0.23    0.00 0.18   0.01   0.08  0.19  0.34  0.64  1606    1
## Y.10        0.17    0.00 0.14   0.00   0.06  0.13  0.25  0.53  3903    1
## Y.01        0.37    0.00 0.21   0.02   0.20  0.36  0.52  0.81  3022    1
## Y.11        0.23    0.00 0.17   0.01   0.09  0.20  0.34  0.65  3106    1
## X0.Y00      0.11    0.00 0.11   0.00   0.03  0.08  0.16  0.40  1726    1
## X1.Y00      0.12    0.00 0.11   0.00   0.03  0.08  0.17  0.39  1701    1
## X0.Y10      0.08    0.00 0.09   0.00   0.02  0.05  0.12  0.32  2831    1
## X1.Y10      0.08    0.00 0.09   0.00   0.02  0.05  0.12  0.32  3188    1
## X0.Y01      0.18    0.00 0.14   0.01   0.07  0.15  0.26  0.54  2486    1
## X1.Y01      0.18    0.00 0.14   0.01   0.07  0.15  0.26  0.54  2670    1
## X0.Y11      0.12    0.00 0.11   0.00   0.04  0.08  0.16  0.41  2722    1
## X1.Y11      0.12    0.00 0.11   0.00   0.03  0.09  0.17  0.39  2419    1
## lp__       -9.32    0.05 1.60 -13.50 -10.09 -8.96 -8.11 -7.31   978    1
## 
## Samples were drawn using NUTS(diag_e) at Mon Nov 11 16:34:53 2024.
## For each parameter, n_eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor on split chains (at 
## convergence, Rhat=1).
</code></pre>
<h2 id="stan-code">Stan code</h2>
<pre><code class="language-r">CausalQueries:::stanmodels$simplexes
</code></pre>
<pre><code>S4 class stanmodel 'simplexes' coded as follows:
functions{
  row_vector col_sums(matrix X) {
    row_vector[cols(X)] s ;
    s = rep_row_vector(1, rows(X)) * X ;
    return s ;
  }
}
data {
int&lt;lower=1&gt; n_params;
int&lt;lower=1&gt; n_paths;
int&lt;lower=1&gt; n_types;
int&lt;lower=1&gt; n_param_sets;
int&lt;lower=1&gt; n_nodes;
array[n_param_sets] int&lt;lower=1&gt; n_param_each;
int&lt;lower=1&gt; n_data;
int&lt;lower=1&gt; n_events;
int&lt;lower=1&gt; n_strategies;
int&lt;lower=0, upper=1&gt; keep_type_distribution;
vector&lt;lower=0&gt;[n_params] lambdas_prior;
array[n_param_sets] int&lt;lower=1&gt; l_starts;
array[n_param_sets] int&lt;lower=1&gt; l_ends;
array[n_nodes] int&lt;lower=1&gt; node_starts;
array[n_nodes] int&lt;lower=1&gt; node_ends;
array[n_strategies] int&lt;lower=1&gt; strategy_starts;
array[n_strategies] int&lt;lower=1&gt; strategy_ends;
matrix[n_params, n_types] P;
matrix[n_params, n_paths] parmap;
matrix[n_paths, n_data] map;
matrix&lt;lower=0,upper=1&gt;[n_events,n_data] E;
array[n_events] int&lt;lower=0&gt; Y;
}
parameters {
vector&lt;lower=0&gt;[n_params - n_param_sets] gamma;
}
transformed parameters {
vector&lt;lower=0, upper=1&gt;[n_params] lambdas;
vector&lt;lower=1&gt;[n_param_sets] sum_gammas;
matrix[n_params, n_paths] parlam;
matrix[n_nodes, n_paths] parlam2;
vector&lt;lower=0, upper=1&gt;[n_paths] w_0;
vector&lt;lower=0, upper=1&gt;[n_data] w;
vector&lt;lower=0, upper=1&gt;[n_events] w_full;
// Cases in which a parameter set has only one value need special handling
// they have no gamma components and sum_gamma needs to be made manually
for (i in 1:n_param_sets) {
  if (l_starts[i] &gt;= l_ends[i]) {
    sum_gammas[i] = 1;
    lambdas[l_starts[i]] = 1;
    }
  else if (l_starts[i] &lt; l_ends[i]) {
    sum_gammas[i] =
    1 + sum(gamma[(l_starts[i] - (i-1)):(l_ends[i] - i)]);
    lambdas[l_starts[i]:l_ends[i]] =
    append_row(1, gamma[(l_starts[i] - (i-1)):(l_ends[i] - i)]) /
      sum_gammas[i];
    }
  }
// Mapping from parameters to data types
// (usual case): [n_par * n_data] * [n_par * n_data]
parlam  = rep_matrix(lambdas, n_paths) .* parmap;
// Sum probability over nodes on each path
for (i in 1:n_nodes) {
 parlam2[i,] = col_sums(parlam[(node_starts[i]):(node_ends[i]),]);
 }
// then take product  to get probability of data type on path
for (i in 1:n_paths) {
  w_0[i] = prod(parlam2[,i]);
 }
 // last (if confounding): map to n_data columns instead of n_paths
 w = map'*w_0;
  // Extend/reduce to cover all observed data types
 w_full = E * w;
}
model {
// Dirichlet distributions
for (i in 1:n_param_sets) {
  target += dirichlet_lpdf(lambdas[l_starts[i]:l_ends[i]]  |
    lambdas_prior[l_starts[i] :l_ends[i]]);
  target += -n_param_each[i] * log(sum_gammas[i]);
 }
// Multinomials
// Note with censoring event_probabilities might not sum to 1
for (i in 1:n_strategies) {
  target += multinomial_lpmf(
  Y[strategy_starts[i]:strategy_ends[i]] |
    w_full[strategy_starts[i]:strategy_ends[i]]/
     sum(w_full[strategy_starts[i]:strategy_ends[i]]));
 }
}
// Option to export distribution of causal types
generated quantities{
vector[n_types] types;
if (keep_type_distribution == 1){
for (i in 1:n_types) {
   types[i] = prod(P[, i].*lambdas + 1 - P[,i]);
}}
 if (keep_type_distribution == 0){
    types = rep_vector(1, n_types);
 }
} 
</code></pre>
<h2 id="performance">Performance</h2>
<p>effect of model complexity on run-time</p>
<pre><code class="language-r">model &lt;- list(
  CausalQueries::make_model(&quot;X -&gt; Y&quot;),
  CausalQueries::make_model(&quot;X1 -&gt; Y &lt;- X2&quot;),
  CausalQueries::make_model(&quot;X1 -&gt; Y; X2 -&gt; Y; X3 -&gt; Y&quot;)
)

iter &lt;- 3000

data &lt;- expand_grid(X1 = 0:1, X2 = 0:1, X3 = 0:1, X4 = 0:1) |&gt;
  uncount(20) |&gt;
  mutate(Y = 1*(X1 + X2 - X3 + X1*X4 + rnorm(n()) &gt; 0))

options(mc.cores = parallel::detectCores())
</code></pre>
<pre><code class="language-r">benchmark_model &lt;- microbenchmark::microbenchmark(
  m1 = CausalQueries::update_model(model[[1]], data, iter = iter),
  m2 = CausalQueries::update_model(model[[2]], data, iter = iter),
  m3 = CausalQueries::update_model(model[[3]], data, iter = iter),
  times = 5
)

kable(summary(benchmark_model), digits = 2)
</code></pre>
<table>
<thead>
<tr>
<th align="left">expr</th>
<th align="right">min</th>
<th align="right">lq</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">uq</th>
<th align="right">max</th>
<th align="right">neval</th>
<th align="left">cld</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">m1</td>
<td align="right">8.46</td>
<td align="right">8.58</td>
<td align="right">9.00</td>
<td align="right">8.77</td>
<td align="right">9.37</td>
<td align="right">9.80</td>
<td align="right">5</td>
<td align="left">a</td>
</tr>
<tr>
<td align="left">m2</td>
<td align="right">10.15</td>
<td align="right">10.51</td>
<td align="right">10.53</td>
<td align="right">10.51</td>
<td align="right">10.57</td>
<td align="right">10.91</td>
<td align="right">5</td>
<td align="left">b</td>
</tr>
<tr>
<td align="left">m3</td>
<td align="right">87.16</td>
<td align="right">87.27</td>
<td align="right">87.97</td>
<td align="right">87.29</td>
<td align="right">88.87</td>
<td align="right">89.24</td>
<td align="right">5</td>
<td align="left">c</td>
</tr>
</tbody>
</table>
<p>effect of data size on run-time</p>
<pre><code class="language-r">model &lt;- CausalQueries::make_model(&quot;X -&gt; Y&quot;)

data &lt;- lapply(10^c(1:5), function(n) {
  CausalQueries::make_data(model, n)
})
</code></pre>
<pre><code class="language-r">benchmark_data &lt;- microbenchmark::microbenchmark(
  d0 = CausalQueries::update_model(model, data[[1]], iter = iter),
  d1 = CausalQueries::update_model(model, data[[2]], iter = iter),
  d2 = CausalQueries::update_model(model, data[[3]], iter = iter),
  d3 = CausalQueries::update_model(model, data[[4]], iter = iter),
  d4 = CausalQueries::update_model(model, data[[5]], iter = iter),
  times = 5
)

kable(summary(benchmark_data), digits = 2)
</code></pre>
<table>
<thead>
<tr>
<th align="left">expr</th>
<th align="right">min</th>
<th align="right">lq</th>
<th align="right">mean</th>
<th align="right">median</th>
<th align="right">uq</th>
<th align="right">max</th>
<th align="right">neval</th>
<th align="left">cld</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">d0</td>
<td align="right">7.82</td>
<td align="right">8.13</td>
<td align="right">8.41</td>
<td align="right">8.59</td>
<td align="right">8.67</td>
<td align="right">8.84</td>
<td align="right">5</td>
<td align="left">a</td>
</tr>
<tr>
<td align="left">d1</td>
<td align="right">8.25</td>
<td align="right">8.29</td>
<td align="right">8.53</td>
<td align="right">8.36</td>
<td align="right">8.71</td>
<td align="right">9.04</td>
<td align="right">5</td>
<td align="left">a</td>
</tr>
<tr>
<td align="left">d2</td>
<td align="right">9.49</td>
<td align="right">9.57</td>
<td align="right">9.93</td>
<td align="right">9.95</td>
<td align="right">10.27</td>
<td align="right">10.35</td>
<td align="right">5</td>
<td align="left">a</td>
</tr>
<tr>
<td align="left">d3</td>
<td align="right">13.26</td>
<td align="right">14.01</td>
<td align="right">14.27</td>
<td align="right">14.25</td>
<td align="right">14.77</td>
<td align="right">15.05</td>
<td align="right">5</td>
<td align="left">b</td>
</tr>
<tr>
<td align="left">d4</td>
<td align="right">27.89</td>
<td align="right">27.89</td>
<td align="right">30.99</td>
<td align="right">27.98</td>
<td align="right">33.29</td>
<td align="right">37.90</td>
<td align="right">5</td>
<td align="left">c</td>
</tr>
</tbody>
</table>
</div>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js" defer></script>
</body>
</html>
